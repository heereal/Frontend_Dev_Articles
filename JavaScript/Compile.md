# 컴파일

## 컴파일이란?
- 컴파일은 **high level의 프로그래밍 언어(소스 코드)를 기게어 혹은 기계어와 유사한 low level로 해석**하는 과정이다.
- 프로그래머가 작성하는 소스 코드는 컴퓨터가 이해할 수 없기 때문에 작성한 소스 코드를 기계어로 번역하는 컴파일 과정이 필요하다.

<br/>

## 자바스크립트 엔진의 동작 과정
1. **파싱**: 자바스크립트 엔진이 스크립트를 읽는다. 
2. **컴파일**: 읽어들인 스크립트를 기계어로 전환한다. 
3. **실행**: 기계어로 전환된 코드가 실행된다. 기계어로 전환되었기 때문에 실행속도가 빠르다.

<br/>

## 자바스크립트에서 사용하는 컴파일 방식
![image (17)](https://github.com/heereal/Frontend_Dev_Articles/assets/117061017/c0a5e71f-208b-4c3c-b416-cedcb62eb84b)
-  먼저 **소스 코드**를 파싱하여 중간언어(IR)인 **바이트 코드** 형태로 변환한다. 
-  이때 인터프리터 모드라면 바이트코드를 하나씩 읽어가며 동작을 수행하고, JIT 모드라면 생성된 바이트코드를 기반으로 **네이티브 코드(기계어)** 로 컴파일하여 수행하게 된다.

<br/>

## 컴파일의 종류
![image (16)](https://github.com/heereal/Frontend_Dev_Articles/assets/117061017/4a338690-1cfb-43e5-b1d9-721f67feab9a)

### 1. Compiler
- 컴파일러는 코드를 실행하지 않으며, **디스크에 번역이 완료된 코드를 저장**한다. 저장된 코드는 언제든 실행될 수 있다.
- 프로그램이 한번 컴파일 되었다면, 컴파일 된 프로그램만 있으면 실행이 가능하므로 컴파일러나 원본 소스 코드는 필요없게 된다.
- 프로그램을 컴파일할 때에는 지정된 운영체제에 따라 컴파일되며, 다른 운영체제에서는 동작하지 않는다.
- 컴파일된 프로그램은 운영체제에 따라 최적화할 수 있으며, 이미 해석된 코드를 바로 실행하므로 빠르게 동작한다.
- 컴파일러의 경우 실행 속도가 빠르지만, 전체 코드를 컴파일한 후에 에러를 확인할 수 있으므로 디버깅이 불편하다. 수정사항이 발생하면 전체 코드를 다시 컴파일해야한다.

<br/>

### 2. Interpreter
- 인터프리터는 **코드가 번역된 후 컴퓨터로 전달되어 바로 실행**된다.
- 전체 소스 코드를 한번에 변환하는게 아니라 코드를 한 줄 씩 읽어들여 중간코드나 기계어로 변환해서 임시파일에 저장하고, 변환한 것을 바로 실행한다.
- 프로그램을 실행시키기 위해서는 반드시 인터프리터가 설치되어 있어야 한다.
- 인터프리터는 운영 체제에 관계없이 실행 가능하기 때문에 운영체제의 컴퓨터에서도 실행할 수 있다.
- 인터프리터는 해석과 실행을 동시에 수행하기 때문에 컴파일된 코드보다는 느리게 실행된다. 하지만 한 줄 씩 실행할 때마다 에러를 확인할 수 있으므로 실시간 코드 수정이 가능하다.

<br/>

### 3. JIT (Just In Time)
- **동적 컴파일**이라고도 불리는 JIT는 컴퓨터 프로그램의 런타임 성능을 개선하기 위해서 사용되는 기술로, 인터프리터와 정적 컴파일을 혼합한 방식으로 생각할 수 있다.
- **프로그램 실행 시점에 인터프리터 방식으로 기계어 코드를 생성하면서 그 코드를 캐싱**하여, 같은 함수가 여러번 불릴 때마다 매번 기계어 코드를 생성하는 것을 방지한다.
- 좀 더 구체적으로 말하면, 실행 시점에 바이트 코드를 기계어로 번역하는 역할을 한다.
- JIT는 인터프리터 방식보다는 빠르며 정적 컴파일 방식보다는 느리지만, 실행 환경에 맞추어 생성된 코드의 선택 및 최적화를 할 수 있다는 장점이 있다.

<br/>

### 4. Adaptive Compilation
- 모든 코드에 일괄적으로 같은 수준의 최적화를 적용하는 것이 아니라, **반복 수행되는 정도에 따라 유동적으로 서로 다른 최적화 수준을 적용**하는 방식이다.
- 기본적으로 모든 코드는 처음에 인터프리터로 해석한다. 그러다가 자주 반복되는 부분(hotspot)이 발견되면, 그 부분에 대해서만 JIT를 적용하여 네이티브 코드로 변환한다.
- 최근 자바스크립트 엔진들은 대부분 adaptive compilation 방식을 사용하고 있다고 한다.

<br/>

## References
- [JavaScript는 어떻게 컴파일될까?](https://velog.io/@wish/JavaScript%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EB%90%A0%EA%B9%8C)
